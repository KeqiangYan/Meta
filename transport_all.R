#将物种和功能结合的柱状图
a1<-read.table("transport_S8.txt",header = T, sep = "\t")
Sample<-rep(c("Sample_8"),dim(a1)[1])
b1<-cbind(a1,Sample)
a2<-read.table("transport_S10.txt",header = T, sep = "\t")
Sample<-rep(c("Sample_10"),dim(a2)[1])
b2<-cbind(a2,Sample)
a3<-read.table("transport_S12.txt",header = T, sep = "\t")
Sample<-rep(c("Sample_12"),dim(a3)[1])
b3<-cbind(a3,Sample)
a4<-read.table("transport_S14.txt",header = T, sep = "\t")
Sample<-rep(c("Sample_14"),dim(a4)[1])
b4<-cbind(a4,Sample)
a5<-read.table("transport_S16.txt",header = T, sep = "\t")
Sample<-rep(c("Sample_16"),dim(a5)[1])
b5<-cbind(a5,Sample)
a6<-read.table("transport_S18.txt",header = T, sep = "\t")
Sample<-rep(c("Sample_18"),dim(a6)[1])
b6<-cbind(a6,Sample)
a7<-read.table("transport_S20.txt",header = T, sep = "\t")
Sample<-rep(c("Sample_20"),dim(a7)[1])
b7<-cbind(a7,Sample)
a8<-read.table("transport_S22.txt",header = T, sep = "\t")
Sample<-rep(c("Sample_22"),dim(a8)[1])
b8<-cbind(a8,Sample)
a9<-read.table("transport_S24.txt",header = T, sep = "\t")
Sample<-rep(c("Sample_24"),dim(a9)[1])
b9<-cbind(a9,Sample)
a10<-read.table("transport_S26.txt",header = T, sep = "\t")
Sample<-rep(c("Sample_26"),dim(a10)[1])
b10<-cbind(a10,Sample)
a11<-read.table("transport_S28.txt",header = T, sep = "\t")
Sample<-rep(c("Sample_28"),dim(a11)[1])
b11<-cbind(a11,Sample)
all<-rbind(b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11)
write.table(all,"all_samples.ibaq",sep="\t")
all_6<-rbind(b1,b2,b3,b4,b5,b6)
all_5<-rbind(b7,b8,b9,b10,b11)
#abc<-subset(a,Cog=="COG0834"|Cog=="COG0683"|Cog=="COG4166"|Cog=="COG0747"|Cog=="COG1653"|Cog=="COG1879")
all_5$Code<-factor(all_5$Code,levels = c("COG0834","COG0683","COG0747","COG4166","COG1653","COG1879","COG4213","COG2113","COG4521","COG1840","COG0226","COG3221","COG0715","COG4663","COG1638","COG2358","COG1629"))
all_6$Code<-factor(all_6$Code,levels = c("COG0834","COG0683","COG0747","COG4166","COG1653","COG1879","COG4213","COG2113","COG4521","COG1840","COG0226","COG3221","COG0715","COG4663","COG1638","COG2358","COG1629"))
all$Code<-factor(all$Code,levels = c("COG0834","COG0683","COG0747","COG4166","COG1653","COG1879","COG4213","COG2113","COG4521","COG1840","COG0226","COG3221","COG0715","COG4663","COG1638","COG2358","COG1629"))
library(ggplot2)
#cb_palette <-c("#999999","#E69F00","#009E73","#56B4E9","#F0E442","#0072B2","#D55E00","#CC79A7","#999999","#E69F00")
png("all_6.png",width = 1200,height = 800)
ggplot(all_6,aes(x=Code,y=iBAQ,fill=Taxonomy))+geom_bar(stat="identity")+facet_grid(Sample ~.)+ylab("Abundance")
dev.off()
png("all_5.png",width = 1200,height = 800)
ggplot(all_5,aes(x=Code,y=iBAQ,fill=Taxonomy))+geom_bar(stat="identity")+facet_grid(Sample ~.)+ylab("Abundance")
dev.off()
png("all.png",width = 1200,height = 800)
ggplot(all,aes(x=Code,y=iBAQ,fill=Taxonomy))+guides(fill=guide_legend(reverse = TRUE))+geom_bar(stat="identity")+facet_grid(Sample ~.)+ylab("Percent of Spectra")
dev.off()



