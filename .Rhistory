png("heatmap_10.png",width = 500,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S10")
dev.off()
t<-read.table("26I_S12.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
row.names(r)<-r[,1]
r<-r[,-1]
r[is.na(r)]<-min(t$iBAQ[t$iBAQ>0])*0.01
r[r==0]<-min(t$iBAQ[t$iBAQ>0])*0.01
r1<-log10(r)
library(pheatmap)
png("heatmap_12.png",width = 500,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S12")
dev.off()
t<-read.table("26I_S14.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
row.names(r)<-r[,1]
r<-r[,-1]
r[is.na(r)]<-min(t$iBAQ[t$iBAQ>0])*0.01
r[r==0]<-min(t$iBAQ[t$iBAQ>0])*0.01
r1<-log10(r)
library(pheatmap)
png("heatmap_14.png",width = 500,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S14")
dev.off()
t<-read.table("26I_S16.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
row.names(r)<-r[,1]
r<-r[,-1]
r[is.na(r)]<-min(t$iBAQ[t$iBAQ>0])*0.01
r[r==0]<-min(t$iBAQ[t$iBAQ>0])*0.01
r1<-log10(r)
library(pheatmap)
png("heatmap_16.png",width = 500,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S16")
dev.off()
t<-read.table("26I_S20.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
row.names(r)<-r[,1]
r<-r[,-1]
r[is.na(r)]<-min(t$iBAQ[t$iBAQ>0])*0.01
r[r==0]<-min(t$iBAQ[t$iBAQ>0])*0.01
r1<-log10(r)
library(pheatmap)
png("heatmap_20.png",width = 500,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S20")
dev.off()
t<-read.table("26I_S22.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
row.names(r)<-r[,1]
r<-r[,-1]
r[is.na(r)]<-min(t$iBAQ[t$iBAQ>0])*0.01
r[r==0]<-min(t$iBAQ[t$iBAQ>0])*0.01
r1<-log10(r)
library(pheatmap)
png("heatmap_22.png",width = 500,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S22")
dev.off()
t<-read.table("26I_S24.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
row.names(r)<-r[,1]
r<-r[,-1]
r[is.na(r)]<-min(t$iBAQ[t$iBAQ>0])*0.01
r[r==0]<-min(t$iBAQ[t$iBAQ>0])*0.01
r1<-log10(r)
library(pheatmap)
png("heatmap_24.png",width = 500,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S24")
dev.off()
t<-read.table("26I_S26.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
row.names(r)<-r[,1]
r<-r[,-1]
r[is.na(r)]<-min(t$iBAQ[t$iBAQ>0])*0.01
r[r==0]<-min(t$iBAQ[t$iBAQ>0])*0.01
r1<-log10(r)
library(pheatmap)
png("heatmap_26.png",width = 500,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S26")
dev.off()
t<-read.table("26I_S28.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
row.names(r)<-r[,1]
r<-r[,-1]
r[is.na(r)]<-min(t$iBAQ[t$iBAQ>0])*0.01
r[r==0]<-min(t$iBAQ[t$iBAQ>0])*0.01
r1<-log10(r)
library(pheatmap)
png("heatmap_29.png",width = 500,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S28")
dev.off()
t<-read.table("26I_S8.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
row.names(r)<-r[,1]
r<-r[,-1]
r[is.na(r)]<-min(t$iBAQ[t$iBAQ>0])*0.01
r[r==0]<-min(t$iBAQ[t$iBAQ>0])*0.01
r1<-log10(r)
library(pheatmap)
png("heatmap_8.png",width = 600,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S8")
dev.off()
t<-read.table("26I_S10.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
row.names(r)<-r[,1]
r<-r[,-1]
r[is.na(r)]<-min(t$iBAQ[t$iBAQ>0])*0.01
r[r==0]<-min(t$iBAQ[t$iBAQ>0])*0.01
r1<-log10(r)
library(pheatmap)
png("heatmap_10.png",width = 600,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S10")
dev.off()
t<-read.table("26I_S12.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
row.names(r)<-r[,1]
r<-r[,-1]
r[is.na(r)]<-min(t$iBAQ[t$iBAQ>0])*0.01
r[r==0]<-min(t$iBAQ[t$iBAQ>0])*0.01
r1<-log10(r)
library(pheatmap)
png("heatmap_12.png",width = 600,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S12")
dev.off()
t<-read.table("26I_S14.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
row.names(r)<-r[,1]
r<-r[,-1]
r[is.na(r)]<-min(t$iBAQ[t$iBAQ>0])*0.01
r[r==0]<-min(t$iBAQ[t$iBAQ>0])*0.01
r1<-log10(r)
library(pheatmap)
png("heatmap_14.png",width = 600,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S14")
dev.off()
t<-read.table("26I_S16.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
row.names(r)<-r[,1]
r<-r[,-1]
r[is.na(r)]<-min(t$iBAQ[t$iBAQ>0])*0.01
r[r==0]<-min(t$iBAQ[t$iBAQ>0])*0.01
r1<-log10(r)
library(pheatmap)
png("heatmap_16.png",width = 600,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S16")
dev.off()
t<-read.table("26I_S18.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
row.names(r)<-r[,1]
r<-r[,-1]
r[is.na(r)]<-min(t$iBAQ[t$iBAQ>0])*0.01
r[r==0]<-min(t$iBAQ[t$iBAQ>0])*0.01
r1<-log10(r)
library(pheatmap)
png("heatmap_18.png",width = 600,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S18")
dev.off()
t<-read.table("26I_S22.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
row.names(r)<-r[,1]
r<-r[,-1]
r[is.na(r)]<-min(t$iBAQ[t$iBAQ>0])*0.01
r[r==0]<-min(t$iBAQ[t$iBAQ>0])*0.01
r1<-log10(r)
library(pheatmap)
png("heatmap_22.png",width = 600,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S22")
dev.off()
t<-read.table("26I_S22.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
row.names(r)<-r[,1]
r<-r[,-1]
r[is.na(r)]<-min(t$iBAQ[t$iBAQ>0])*0.01
r[r==0]<-min(t$iBAQ[t$iBAQ>0])*0.01
r1<-log10(r)
library(pheatmap)
png("heatmap_22.png",width = 650,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S22")
dev.off()
t<-read.table("26I_S22.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
row.names(r)<-r[,1]
r<-r[,-1]
r[is.na(r)]<-min(t$iBAQ[t$iBAQ>0])*0.01
r[r==0]<-min(t$iBAQ[t$iBAQ>0])*0.01
r1<-log10(r)
library(pheatmap)
png("heatmap_22.png",width = 700,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S22")
dev.off()
t<-read.table("26I_S22.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
row.names(r)<-r[,1]
r<-r[,-1]
r[is.na(r)]<-min(t$iBAQ[t$iBAQ>0])*0.01
r[r==0]<-min(t$iBAQ[t$iBAQ>0])*0.01
r1<-log10(r)
library(pheatmap)
png("heatmap_22.png",width = 600,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S22")
dev.off()
t<-read.table("26I_S10.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
row.names(r)<-r[,1]
r<-r[,-1]
r[is.na(r)]<-min(t$iBAQ[t$iBAQ>0])*0.01
r[r==0]<-min(t$iBAQ[t$iBAQ>0])*0.01
r1<-log10(r)
library(pheatmap)
png("heatmap_10.png",width = 650,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S10")
dev.off()
View(t)
t<-read.table("26I_S10.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
row.names(r)<-r[,1]
r<-r[,-1]
View(r)
t<-read.table("26I_S10.txt",header=T,sep = "\t")
library(reshape2)
r<-dcast(t,Code~Taxonomy)
r
t28<-read.table("26I_S28.txt",header=T,sep = "\t")
r28<-dcast(t28,Code~Taxonomy)
View(t28)
View(r28)
b28<-[r28$Code,r28$`delta/epsilon subdivisions`]
b28<-r28[r28$Code,r28$`delta/epsilon subdivisions`]
b28<-r28[,r28$Code,r28$`delta/epsilon subdivisions`]
b28<-r28[,(r28$Code,r28$`delta/epsilon subdivisions`)]
b28<-r28[,c(r28$Code,r28$`delta/epsilon subdivisions`)]
b28<-c(r28$Code,r28$`delta/epsilon subdivisions`)
b28<-subset(r28,Code,`delta/epsilon subdivisions`)
b28<-subset(r28,select=c(Code,`delta/epsilon subdivisions`))
View(b28)
library(reshape2)
t8<-read.table("26I_S8.txt",header=T,sep = "\t")
r8<-dcast(t8,Code~Taxonomy)
b8<-subset(r8,select=c(Code,`delta/epsilon subdivisions`))
t10<-read.table("26I_S10.txt",header=T,sep = "\t")
r10<-dcast(t10,Code~Taxonomy)
b10<-subset(r10,select=c(Code,`delta/epsilon subdivisions`))
t12<-read.table("26I_S12.txt",header=T,sep = "\t")
r12<-dcast(t12,Code~Taxonomy)
b12<-subset(r12,select=c(Code,`delta/epsilon subdivisions`))
t14<-read.table("26I_S14.txt",header=T,sep = "\t")
r14<-dcast(t14,Code~Taxonomy)
b14<-subset(r14,select=c(Code,`delta/epsilon subdivisions`))
t16<-read.table("26I_S16.txt",header=T,sep = "\t")
r16<-dcast(t16,Code~Taxonomy)
b16<-subset(r16,select=c(Code,`delta/epsilon subdivisions`))
t18<-read.table("26I_S18.txt",header=T,sep = "\t")
r18<-dcast(t18,Code~Taxonomy)
b18<-subset(r18,select=c(Code,`delta/epsilon subdivisions`))
t20<-read.table("26I_S20.txt",header=T,sep = "\t")
r20<-dcast(t20,Code~Taxonomy)
b20<-subset(r20,select=c(Code,`delta/epsilon subdivisions`))
t22<-read.table("26I_S22.txt",header=T,sep = "\t")
r22<-dcast(t22,Code~Taxonomy)
b22<-subset(r22,select=c(Code,`delta/epsilon subdivisions`))
t24<-read.table("26I_S24.txt",header=T,sep = "\t")
r24<-dcast(t24,Code~Taxonomy)
b24<-subset(r24,select=c(Code,`delta/epsilon subdivisions`))
t26<-read.table("26I_S26.txt",header=T,sep = "\t")
r26<-dcast(t26,Code~Taxonomy)
b26<-subset(r26,select=c(Code,`delta/epsilon subdivisions`))
t28<-read.table("26I_S28.txt",header=T,sep = "\t")
r28<-dcast(t28,Code~Taxonomy)
b28<-subset(r28,select=c(Code,`delta/epsilon subdivisions`))
#函数multimerge
multimerge<-function(dat=list(),...){
if(length(dat)<2)return(as.data.frame(dat))
mergedat<-dat[[1]]
dat[[1]]<-NULL
for(i in dat){
mergedat<-merge(mergedat,i,...)
}
return(mergedat)
}
c<-multimerge(list(b8,b10,b12,b14,b16,b18,b20,b22,b24,b26,b28))
names(c)<-c("Code","S8","S10","S12","S14","S16","S18","S20","S22","S24","S26","S28")
View(c)
View(b28)
View(b22)
c<-multimerge(list(b8,b10,b12,b14,b16,b18,b20,b22,b24,b26,b28))
multimerge<-function(dat=list(),...){
if(length(dat)<2)return(as.data.frame(dat))
mergedat<-dat[[1]]
dat[[1]]<-NULL
for(i in dat){
mergedat<-merge(mergedat,i,...,all=T)
}
return(mergedat)
}
c<-multimerge(list(b8,b10,b12,b14,b16,b18,b20,b22,b24,b26,b28))
View(c)
t8<-read.table("26I_S8.txt",header=T,sep = "\t")
r8<-dcast(t8,Code~Taxonomy)
b8<-subset(r8,select=c(Code,`delta/epsilon subdivisions`))
names(b8)<-c("Code","S8")
t10<-read.table("26I_S10.txt",header=T,sep = "\t")
r10<-dcast(t10,Code~Taxonomy)
b10<-subset(r10,select=c(Code,`delta/epsilon subdivisions`))
names(b10)<-c("Code","S10")
t12<-read.table("26I_S12.txt",header=T,sep = "\t")
r12<-dcast(t12,Code~Taxonomy)
b12<-subset(r12,select=c(Code,`delta/epsilon subdivisions`))
names(b12)<-c("Code","S12")
t14<-read.table("26I_S14.txt",header=T,sep = "\t")
r14<-dcast(t14,Code~Taxonomy)
b14<-subset(r14,select=c(Code,`delta/epsilon subdivisions`))
names(b14)<-c("Code","S14")
t16<-read.table("26I_S16.txt",header=T,sep = "\t")
r16<-dcast(t16,Code~Taxonomy)
b16<-subset(r16,select=c(Code,`delta/epsilon subdivisions`))
names(b16)<-c("Code","S16")
t18<-read.table("26I_S18.txt",header=T,sep = "\t")
r18<-dcast(t18,Code~Taxonomy)
b18<-subset(r18,select=c(Code,`delta/epsilon subdivisions`))
names(b18)<-c("Code","S18")
t20<-read.table("26I_S20.txt",header=T,sep = "\t")
r20<-dcast(t20,Code~Taxonomy)
b20<-subset(r20,select=c(Code,`delta/epsilon subdivisions`))
names(b20)<-c("Code","S20")
t22<-read.table("26I_S22.txt",header=T,sep = "\t")
r22<-dcast(t22,Code~Taxonomy)
b22<-subset(r22,select=c(Code,`delta/epsilon subdivisions`))
names(b22)<-c("Code","S22")
t24<-read.table("26I_S24.txt",header=T,sep = "\t")
r24<-dcast(t24,Code~Taxonomy)
b24<-subset(r24,select=c(Code,`delta/epsilon subdivisions`))
names(b24)<-c("Code","S24")
t26<-read.table("26I_S26.txt",header=T,sep = "\t")
r26<-dcast(t26,Code~Taxonomy)
b26<-subset(r26,select=c(Code,`delta/epsilon subdivisions`))
names(b26)<-c("Code","S26")
t28<-read.table("26I_S28.txt",header=T,sep = "\t")
r28<-dcast(t28,Code~Taxonomy)
b28<-subset(r28,select=c(Code,`delta/epsilon subdivisions`))
names(b28)<-c("Code","S28")
#函数multimerge
multimerge<-function(dat=list(),...){
if(length(dat)<2)return(as.data.frame(dat))
mergedat<-dat[[1]]
dat[[1]]<-NULL
for(i in dat){
mergedat<-merge(mergedat,i,...,all=T)
}
return(mergedat)
}
c<-multimerge(list(b8,b10,b12,b14,b16,b18,b20,b22,b24,b26,b28))
View(t22)
View(c)
names(c)<-c("Code","S8","S10","S12","S14","S16","S18","S20","S22","S24","S26","S28")
View(c)
c[is.na(c)]<-0
c[c==0]<-min(c[c>0])*0.01
c[c==0]<-min(c[data>0])*0.01
c, which(c== min(c), arr.ind = TRUE)
which(c== min(c), arr.ind = TRUE)
row.names(c)<-c[,1]
c<-c[,-1]
which(c== min(c), arr.ind = TRUE)
min(c)
c[c>0]
min(c[c>0])
c[c==0]<-min(c[c>0])*0.01
r1<-log10(c)
library(pheatmap)
png("heatmap_10.png",width = 650,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "S10")
dev.off()
png("delta/epsilon subdivisions.png",width = 650,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "delta/epsilon subdivisions")
dev.off()
row.names(c)<-c[,1]
c<-c[,-1]
c[c==0]<-min(c[c>0])*0.01
r1<-log10(c)
library(pheatmap)
png("delta/epsilon subdivisions.png",width = 650,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "delta/epsilon subdivisions")
dev.off()
dev.off()
dev.off()
row.names(c)<-c[,1]
c<-c[,-1]
c[c==0]<-min(c[c>0])*0.01
r1<-log10(c)
library(pheatmap)
png("delta/epsilon subdivisions.png",width = 650,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "delta/epsilon subdivisions")
dev.off()
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "delta/epsilon subdivisions")
png("delta/epsilon_subdivisions.png",width = 650,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "delta/epsilon subdivisions")
dev.off()
png("delta_epsilon_subdivisions.png",width = 650,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "delta/epsilon subdivisions")
dev.off()
png("delta_epsilon_subdivisions.png",width = 700,height = 700)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 30, cellheight = 12, main = "delta/epsilon subdivisions")
dev.off()
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 40, cellheight = 26, main = "delta/epsilon subdivisions")
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 36, cellheight = 16, main = "delta/epsilon subdivisions")
png("delta_epsilon_subdivisions.png",width = 700,height = 700)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 36, cellheight = 16, main = "delta/epsilon subdivisions")
dev.off()
png("delta_epsilon_subdivisions.png",width = 500,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 2,annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 36, cellheight = 16, main = "delta/epsilon subdivisions")
dev.off()
png("delta_epsilon_subdivisions.png",width = 500,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,cutree_cols = 0，annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 36, cellheight = 16, main = "delta/epsilon subdivisions")
dev.off()
png("delta_epsilon_subdivisions.png",width = 500,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T，annotation_legend = TRUE,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 36, cellheight = 16, main = "delta/epsilon subdivisions")
dev.off()
png("delta_epsilon_subdivisions.png",width = 500,height = 500)
pheatmap(r1,show_rownames = TRUE,show_colnames = TRUE, cluster_rows = F, cluster_cols = T,color = colorRampPalette(c("white", "brown", "black"))(50),cellwidth = 36, cellheight = 16, main = "delta/epsilon subdivisions")
dev.off()
read.table("S10.ibaq",header = T, sep = "\t")
read.table("S10.sc",header = T, sep = "\t")
ibaq<-read.table("S10.ibaq",header = T, sep = "\t")
sc<-read.table("S10.sc",header = T, sep = "\t")
View(sc)
ibaq<-read.table("S10.ibaq",header = T, sep = "\t")
sc<-read.table("S10.sc",header = T, sep = "\t")
View(sc)
View(ibaq)
acc<-merge(sc,ibaq)
acc
fit <- lm(sc ~ ibaq, data=acc)
fit <- lm(Total_psm_num ~ iBAQ, data=acc)
summary(fit)
plot(acc$Total_psm_num,acc$iBAQ)
plot(acc$Total_psm_num,acc$iBAQ)
abline(fit)
View(acc)
acc$iBAQ==0<-"NA"
acc[acc$iBAQ==0]<-"NA"
acc[acc$iBAQ==0]<-c("NA")
acc$iBAQ
min(acc$iBAQ)
min(acc$iBAQ)<-"NA"
acc$iBAQ==0<-"NA"
acc[acc$iBAQ==0]<-"NA"
acc$iBAQ[acc$iBAQ==0]<-"NA"
acc$iBAQ<-log10(acc$iBAQ)
acc$iBAQ[acc$iBAQ==0]<-NA
acc$iBAQ<-log10(acc$iBAQ)
str(acc)
class(acc$iBAQ)
aa<-as.numeric(acc$iBAQ)
aa
class(aa)
bb<-log10(aa)
bb
acc
acc$iBAQ<-as.numeric(acc$iBAQ)
class(acc$iBAQ)
acc$iBAQ<-log10(acc$iBAQ)
acc
plot(acc$Total_psm_num,acc$iBAQ)
acc
source('~/.active-rstudio-document', echo=TRUE)
acc
acc<-merge(sc,ibaq)
acc
aa<-cbind(acc,psm_percent=round(-log(acc$Total_psm_num/sum(acc$Total_psm_num),6)))
aa
View(aa)
aa<-cbind(acc,psm_percent=round(acc$Total_psm_num/sum(acc$Total_psm_num),6))
aa<-cbind(acc,psm_percent=round(-log(acc$Total_psm_num/sum(acc$Total_psm_num),6)))
aa<-cbind(acc,psm_percent=round(acc$Total_psm_num/sum(acc$Total_psm_num),6))
log10(0.000066)
-log10(0.000066)
aa<-cbind(acc,psm_percent=round(-log10(acc$Total_psm_num/sum(acc$Total_psm_num),6)))
aa<-cbind(acc,psm_percent=round(-log(acc$Total_psm_num/sum(acc$Total_psm_num),6)))
log10(0.000066)
aa<-cbind(acc,psm_percent=round(-log10(acc$Total_psm_num/sum(acc$Total_psm_num),6)))
log10(0.0006)
aa<-cbind(acc,psm_percent=round(-(log10(acc$Total_psm_num/sum(acc$Total_psm_num),6))))
aa<-cbind(acc,psm_percent=round(acc$Total_psm_num/sum(acc$Total_psm_num),6),ibaq_percent=round(acc$iBAQ/sum(acc$iBAQ),6))
a<-aa[,c(4,5)]
View(a)
a[is.na]<-NA
a[a==0]<-NA
View(a)
b<-log10(a)
plot(a)
plot(b)
acc
